<%def name="percent(c1, c2)">\
${"%.2f" % (100 * (c1 / float(c2)))}\
</%def>

<%def name="componentSummary(components, prefix, header=None)">
	% if len(components) > 0:
		<tr><th class="header bordered">${header or upperFirst(prefix)}</th>
		% for category in categories:
			<th class="header bordered ${category}">
				${categoryDesc[category]}
				<table>
					<tr>
						<td class="left-cell small-text">% Cvg</td>
						<td class="right-cell small-text"># APIs</td>
					</tr>
				</table>
			</th>
		% endfor
		</tr>
	% endif

	<%
	ck = components.keys()
	ck.sort()
	%>
	% for component in ck:
		<tr><td class="component bordered"><a href="${prefix}-${component}.html">${component}</a></td>
		% for category in categories:
			<%
			countYes, countNo = countCoverage(components, component, category)
			platform = getCategoryPlatform(category)
			coveragePercent = countYes/float(countYes + countNo)
			className = "bad"
			if coveragePercent >= 0.9:
				className = "good"
			elif coveragePercent >= 0.7:
				className = "warn"
			%> 
			<td class="count bordered ${category} ${className}">
				<table width="100%">
					<tr>
						<td class="left-cell">${"%.2f" % (100 *coveragePercent)}%</td>
						<td class="right-cell">${countYes}</td>
					</tr>
				</table>
			</td>
		% endfor
		</tr>
	% endfor
</%def>

<html>
	<head><link rel="stylesheet" href="coverage.css" type="text/css"/></head>
	<body>
		<h2>Coverage Summary</h2>

		<b>Android Total API Count</b>:
			<span id="android-apis">${totalAPICount["android"]}</span> APIs<br/>

		<b>Android TDoc Coverage</b>:
			<span id="android-doc-coverage">
				${percent(categoryCount["androidTDoc"], totalAPICount["android"])}%
			</span>
			(<span id="android-doc-apis">${categoryCount["androidTDoc"]}</span> Documented APIs)<br/>

		<b>Android Binding Coverage</b>:
			<span id="android-binding-coverage">
				${percent(categoryCount["androidBinding"], totalAPICount["android"])}%
			</span> (<span id="android-binding-apis">${categoryCount["androidBinding"]}</span> Bound APIs)<br/>

		<b>Android Drillbit Coverage</b>:
		<span id="android-test-coverage">
			${percent(categoryCount["androidDrillbit"], totalAPICount["android"])}%
		</span> (<span id="android-test-apis">${categoryCount["androidDrillbit"]}</span> Unit Tested APIs)<br/><br/>

		<h4>Key</h4>
		<table class="bordered">
			<tr>
				<td class="good bordered">&gt;= 90% total coverage</td>
				<td class="warn bordered">&gt;= 70% total coverage</td>
				<td class="bad bordered">&lt; 70% total coverage</td>
			</tr>
		</table><br/>

		<table class="bordered">
		${componentSummary(topLevel, "topLevel", "Top Level Name")}
		${componentSummary(modules, "module")}
		${componentSummary(proxies, "proxy")}
		</table>
	</body>
</html>